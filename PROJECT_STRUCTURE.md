# AI Browser - Project Structure

## Overview

The project is now organized into separate folders for training and application code:

```
ai-browser/
├── model-training/          # Model training & preparation scripts
│   ├── train_navigation_model.py
│   ├── quantize_model.py
│   ├── prepare_model_for_browser.py
│   ├── convert_to_onnx.py
│   ├── convert_quantized_to_onnx.py
│   └── README_TRAINING.md
│
├── src/                     # Browser application code
│   ├── main.js              # Electron main process
│   ├── preload.js           # Preload script
│   ├── config.js            # Configuration
│   ├── aiModelManager.js    # AI model management
│   ├── aiIntentDetector.js  # Intent detection
│   ├── functionOrchestrator.js
│   └── functionRegistry.js
│
├── renderer/                # Renderer process UI
│   ├── index.html
│   └── App.js
│
├── models/                  # Trained models
│   ├── intent-classifier/   # Browser-ready model
│   ├── distilbert-navigation-quantized/
│   └── distilbert-navigation-finetuned/
│
├── docs/                    # Documentation (to be organized)
│   ├── BROWSER_MODEL_GUIDE.md
│   ├── CONFIGURATION.md
│   ├── DEPLOYMENT.md
│   ├── PURE_AI_ARCHITECTURE.md
│   └── ...
│
├── package.json
├── test-intent-classifier.html
└── README.md
```

## Folder Structure

### 1. `model-training/` - ML Training Code

**Purpose:** All Python scripts for training, quantizing, and preparing models

**Files:**
- `train_navigation_model.py` - Train DistilBERT on intent dataset
- `quantize_model.py` - Create FP16 quantized model
- `prepare_model_for_browser.py` - Prepare model for browser use
- `convert_to_onnx.py` - ONNX conversion attempts
- `convert_quantized_to_onnx.py` - Quantized ONNX conversion
- `README_TRAINING.md` - Training documentation

**Usage:**
```bash
cd model-training
python3 train_navigation_model.py
python3 quantize_model.py
python3 prepare_model_for_browser.py
```

**Dependencies:** Python 3.14, PyTorch, Transformers, accelerate

---

### 2. `src/` - Application Source Code

**Purpose:** Browser application JavaScript/Electron code

**Files:**
- `main.js` - Electron main process, model server
- `preload.js` - IPC communication bridge
- `config.js` - Centralized configuration
- `aiModelManager.js` - Load and manage AI models
- `aiIntentDetector.js` - Pure AI intent detection
- `functionOrchestrator.js` - Coordinate function execution
- `functionRegistry.js` - Available browser functions

**Usage:**
```bash
npm start  # Runs src/main.js via Electron
```

**Dependencies:** Electron, Express, @xenova/transformers

---

### 3. `renderer/` - UI Code

**Purpose:** Browser UI rendered in Electron window

**Files:**
- `index.html` - Main HTML template
- `App.js` - React/vanilla JS application

---

### 4. `models/` - Trained Models

**Purpose:** Stored AI models (not in version control)

**Folders:**
- `intent-classifier/` - Browser-ready quantized model (128 MB)
- `distilbert-navigation-quantized/` - Quantized source
- `distilbert-navigation-finetuned/` - Original trained model

**Generated by:** `model-training/prepare_model_for_browser.py`

---

### 5. `docs/` (to be created)

**Purpose:** Documentation files

**Files to move:**
- `BROWSER_MODEL_GUIDE.md`
- `CONFIGURATION.md`
- `DEPLOYMENT.md`
- `PURE_AI_ARCHITECTURE.md`
- `FUNCTION_CALLING_COMMANDS.md`
- `PHASE3_AI_INTEGRATION.md`

---

## Separation Benefits

### Clear Responsibility

**Model Training (Python)**
- ✅ Isolated in `model-training/`
- ✅ Can use different Python env
- ✅ Independent development cycle
- ✅ Easy to version control separately

**Browser App (JavaScript)**
- ✅ Isolated in `src/` and `renderer/`
- ✅ Clean imports and dependencies
- ✅ Easier to test
- ✅ Better code organization

### Development Workflow

**Training New Models:**
```bash
cd model-training
python3 train_navigation_model.py      # Train
python3 quantize_model.py              # Quantize
python3 prepare_model_for_browser.py   # Prepare for browser
# Output: ../models/intent-classifier/
```

**Running Browser:**
```bash
npm start
# Loads from src/main.js
# Serves models from models/intent-classifier/
```

**Building Installer:**
```bash
npm run build
# Packages src/ and models/ into standalone app
```

---

## Path Updates

### Configuration

**`package.json`:**
```json
{
  "main": "src/main.js"
}
```

**`src/main.js`:**
```javascript
// Models path (one level up from src/)
const modelsPath = path.join(__dirname, '..', 'models');

// Renderer path
mainWindow.loadFile(path.join(__dirname, '..', 'renderer', 'index.html'));

// Preload path
preload: path.join(__dirname, 'preload.js')
```

**`src/config.js`:**
```javascript
// No changes needed - uses relative paths
```

---

## Import Structure

### Main Process
```javascript
// src/main.js
const config = require('./config');
const { functionRegistry } = require('./functionRegistry');
```

### Renderer Process
```javascript
// renderer/App.js
import aiModelManager from '../src/aiModelManager.js';
import AIIntentDetector from '../src/aiIntentDetector.js';
```

---

## Git Structure

**`.gitignore` should include:**
```gitignore
# Models (large files)
models/distilbert-navigation-finetuned/
models/distilbert-navigation-quantized/
models/intent-classifier/*.safetensors

# Dependencies
node_modules/
__pycache__/

# Build outputs
dist/

# Python cache
model-training/__pycache__/
*.pyc
```

**What to commit:**
- ✅ `model-training/*.py` - Training scripts
- ✅ `src/**/*.js` - Application code
- ✅ `renderer/**/*` - UI code
- ✅ `package.json` - Dependencies
- ❌ `models/**/*.safetensors` - Too large (280 MB)
- ❌ `node_modules/` - Dependencies

---

## Testing

**Test Training:**
```bash
cd model-training
python3 train_navigation_model.py
# Should output to ../models/
```

**Test Browser:**
```bash
npm start
# Should load from src/main.js
# Should find models in ../models/
```

**Test Paths:**
```bash
node -e "console.log(require('./src/config.js'))"
# Should show correct configuration
```

---

## Future Organization

### Recommended Structure

```
ai-browser/
├── model-training/          # Python ML code
├── src/                     # Application code
│   ├── main/                # Main process
│   │   ├── main.js
│   │   ├── config.js
│   │   └── server.js
│   ├── renderer/            # Renderer process
│   │   ├── App.js
│   │   └── components/
│   └── ai/                  # AI modules
│       ├── aiModelManager.js
│       └── aiIntentDetector.js
├── models/                  # Trained models
├── docs/                    # Documentation
├── tests/                   # Tests
└── scripts/                 # Build scripts
```

---

## Migration Checklist

✅ Created `model-training/` folder
✅ Created `src/` folder
✅ Moved Python training scripts to `model-training/`
✅ Moved JavaScript app code to `src/`
✅ Updated `package.json` main entry point
✅ Updated paths in `src/main.js`
⏳ TODO: Move documentation to `docs/`
⏳ TODO: Update `.gitignore`
⏳ TODO: Update build configuration

---

## Commands Reference

### Training
```bash
# From project root
cd model-training
python3 train_navigation_model.py
python3 quantize_model.py
python3 prepare_model_for_browser.py
```

### Development
```bash
# From project root
npm start                    # Run browser
npm run build                # Build installer
npm test                     # Run tests
```

### Paths
```bash
# Training output
model-training/ → ../models/

# Browser loads
src/main.js → ../models/intent-classifier/

# Renderer loads
renderer/index.html → ../src/aiModelManager.js
```

---

## Summary

**Before:**
```
ai-browser/
├── train_navigation_model.py    # Mixed
├── main.js                       # Mixed
├── aiModelManager.js             # Mixed
└── ...
```

**After:**
```
ai-browser/
├── model-training/               # Python ML code
│   └── train_navigation_model.py
├── src/                          # JavaScript app code
│   ├── main.js
│   └── aiModelManager.js
└── models/                       # Trained models
```

**Benefits:**
- ✅ Clear separation of concerns
- ✅ Independent development cycles
- ✅ Easier to maintain
- ✅ Better for collaboration
- ✅ Cleaner imports
- ✅ Professional structure
